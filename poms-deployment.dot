digraph poms_universe {

label="Deployments relevant for POMS"

poms [ label="POMS" href="https://poms.omroep.nl/" fontcolor=blue ]
poms_backend [ label="POMS backend API" href="https://api.poms.omroep.nl/" fontcolor=blue ]
api [ label = "NPO Frontend API" href="https://rs.poms.omroep.nl/" fontcolor=blue ]
pages_publish [ label = "Pages Publisher"     href="https://publish.pages.omroep.nl/" fontcolor=blue ]
media_publish [ label = "Media Publisher" ]
images_frontend [ label = "Images" href="https://images.poms.omroep.nl" fontcolor=blue]
images_backend [ label = "Images Backend" href="https://images-backend.poms.omroep.nl" fontcolor=blue ]

subgraph cluster_0  {
  label="Generic backend services"
  postgresql
  elasticsearch
  sso
  jms
  ldap
}

subgraph cluster_1  {
  label="VPRO"
  magnolia_frontend
  magnolia_backend
}

subgraph cluster_1  {
  label="World"
  users
  backendsystems
  editors
}
subgraph cluster_3  {
  label="POMS  Services"
  poms
  poms_backend
  pages_publish
  media_publish
  api
  images_frontend
  images_backend
}

subgraph cluster_4  {
  label="NPO Services"
  metis
  pd
  prepr
  miranda
  pluto
  nep
}

editors -> {
  magnolia_backend
  poms
  sso
}[color=gray]

users -> {
  magnolia_frontend
  api
  images_frontend
}[color=gray]

backendsystems -> {
  poms_backend
  pages_publish
}[color=gray]

poms -> {
  postgresql
  jms
  sso
  ldap
  miranda
  prepr
  pd
  metis
  pluto
  nep
}[color=darkgoldenrod3]

poms_backend -> {
  jms
  ldap
  metis
  ldap
}[color=darkorange1]

api -> {
  elasticsearch
}[color=cornflowerblue]

pages_publish-> {
  elasticsearch
  ldap
}[color=darkseagreen]

media_publish -> {
  elasticsearch
  jms
}[color=darkorchid1]
pages_publish -> media_publish[color=gray dir=none]

images_frontend -> {
  postgresql
}
images_backend -> {
  postgresql
  jms
  sso
  ldap
}

magnolia_backend -> {
  poms_backend
  pages_publish
}[color=gray]

magnolia_frontend -> {
  api
}[color=gray]

sso -> ldap[color=gray]

prepr -> metis[color=gray]
pd -> metis[color=gray]

}
