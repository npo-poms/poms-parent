digraph poms_universe {

label="Deployments relevant for POMS"
edge [
      color=gray
      ]

poms [ label="POMS" href="https://poms.omroep.nl/" fontcolor=blue ]
poms_backend [ label="POMS backend API" href="https://api.poms.omroep.nl/" fontcolor=blue ]
api [ label = "NPO Frontend API" href="https://rs.poms.omroep.nl/" fontcolor=blue ]
pages_publish [ label = "Pages Publisher"     href="https://publish.pages.omroep.nl/" fontcolor=blue ]
media_publish [ label = "Media Publisher" ]
images_frontend [ label = "Images" href="https://images.poms.omroep.nl" fontcolor=blue]
images_backend [ label = "Images Backend" href="https://poms.omroep.nl/images/" fontcolor=blue ]


subgraph cluster_0  {
  label="Generic backend services"
  labelloc=b

  bgcolor=azure
  postgresql
  elasticsearch
  sso [ label="SSO" href="https://sso.omroep.nl" fontcolor=blue]
  jms
  ldap
  keycloak [ label = "Keycloak (will replace sso)" ]
  gosa [ label="GOSa" href="https://admin.sso.omroep.nl/" fontcolor=blue]
}

subgraph cluster_1  {
  label="VPRO"
  magnolia_frontend
  magnolia_backend
}

subgraph cluster_1  {
  label="World"
  users
  backendsystems
  editors
}
subgraph cluster_3  {
  label="POMS  Services"
  bgcolor=azure
  poms
  poms_backend
  pages_publish
  media_publish
  api
  images_frontend
  images_backend
}

subgraph cluster_4  {
  label="NPO Services"
  labelloc=b
  metis
  pd
  prepr
  miranda
  pluto
  nep
}

editors -> {
  magnolia_backend
  poms
  sso
}

users -> {
  magnolia_frontend
  api
  images_frontend
}

backendsystems -> {
  poms_backend
  pages_publish
}

poms -> {
  postgresql
  jms
  sso
  ldap
  miranda
  prepr
  pd
  metis
  pluto
  nep
}[color=darkgoldenrod3]

poms_backend -> {
  jms
  ldap
  metis
  ldap
  nep
}[color=darkorange1]

api -> {
  elasticsearch
}[color=cornflowerblue]

pages_publish-> {
  elasticsearch
  ldap
}[color=darkseagreen]

media_publish -> {
  elasticsearch
  jms
}[color=darkorchid1]
pages_publish -> media_publish[dir=none]

images_frontend -> {
  postgresql
}[color=darkolivegreen1]
images_backend -> {
  postgresql
  jms
  sso
  ldap
}[color=darkolivegreen1]

magnolia_backend -> {
  poms_backend
  pages_publish
}

magnolia_frontend -> {
  api
}

sso -> ldap

prepr -> metis
pd -> metis

gosa -> ldap

}
